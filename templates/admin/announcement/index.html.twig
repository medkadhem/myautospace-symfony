{% extends 'admin/base.html.twig' %}

{% block title %}Announcements - Admin{% endblock %}

{% block body %}
<div class="admin-header">
    <h1>Announcements</h1>
{#    <a href="{{ path('app_admin_announcement_new') }}" class="btn btn-primary">Add New Announcement</a>#}
</div>

<div class="table-container">
    <table class="admin-table">
        <thead>
            <tr>
                <th>ID</th>
                <th>Title</th>
                <th>Category</th>
                <th>Brand/Model</th>
                <th>Price</th>
                <th>Status</th>
                <th>Vendor</th>
                <th>Published</th>
                <th>Sponsored</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for announcement in announcements %}
            <tr>
                <td>{{ announcement.id }}</td>
                <td>{{ announcement.title }}</td>
                <td>
                    {% if announcement.categories|length > 0 %}
                        {% for category in announcement.categories %}
                            <span class="badge badge-info">{{ category.name }}</span>
                        {% endfor %}
                    {% else %}
                        N/A
                    {% endif %}
                </td>
                <td>{{ announcement.brand ? announcement.brand ~ ' ' ~ announcement.model : 'N/A' }}</td>
                <td>{{ announcement.price }} TND</td>
                <td><span class="badge badge-{{ announcement.status == 'active' ? 'success' : 'secondary' }}">{{ announcement.status }}</span></td>
                <td>{{ announcement.vendor ? announcement.vendor.email : 'N/A' }}</td>
                <td>{{ announcement.publishedAt ? announcement.publishedAt|date('Y-m-d') : 'N/A' }}</td>
                <td>{{ announcement.isSponsored ? 'Yes' : 'No' }}</td>
                <td class="actions">
                    <a href="{{ path('app_admin_announcement_show', {'id': announcement.id}) }}" class="btn btn-sm btn-info">View</a>
                    <a href="{{ path('app_admin_announcement_edit', {'id': announcement.id}) }}" class="btn btn-sm btn-warning">Edit</a>
                    <form method="post" action="{{ path('app_admin_announcement_delete', {'id': announcement.id}) }}" style="display:inline" onsubmit="return confirm('Are you sure you want to delete this announcement?');">
                        <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ announcement.id) }}">
                        <button class="btn btn-sm btn-danger">Delete</button>
                    </form>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="10" style="text-align: center;">No announcements found</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
