{% extends 'admin/base.html.twig' %}

{% block title %}Reservation Details - Admin{% endblock %}

{% block body %}
<div class="admin-header">
    <h1>Reservation Details</h1>
    <div>
        <a href="{{ path('app_admin_reservation_edit', {'id': reservation.id}) }}" class="btn btn-warning">Edit</a>
        <a href="{{ path('app_admin_reservation_index') }}" class="btn btn-secondary">Back to List</a>
    </div>
</div>

<div class="detail-container">
    <div class="detail-section">
        <h3>Basic Information</h3>
        <div class="detail-grid">
            <div class="detail-item">
                <label>ID:</label>
                <span>{{ reservation.id }}</span>
            </div>
            <div class="detail-item">
                <label>Status:</label>
                <span class="badge badge-{% if reservation.status == 'confirmed' %}success{% elseif reservation.status == 'pending' %}warning{% elseif reservation.status == 'cancelled' %}danger{% else %}secondary{% endif %}">
                    {{ reservation.status }}
                </span>
            </div>
        </div>
    </div>

    <div class="detail-section">
        <h3>Service Information</h3>
        <div class="detail-grid">
            {% if reservation.service %}
                <div class="detail-item">
                    <label>Service:</label>
                    <span>{{ reservation.service.title }}</span>
                </div>
                <div class="detail-item">
                    <label>Service Description:</label>
                    <span>{{ reservation.service.description }}</span>
                </div>
                <div class="detail-item">
                    <label>Service Price:</label>
                    <span>{{ reservation.service.price }} TND</span>
                </div>
                <div class="detail-item">
                    <label>Service Duration:</label>
                    <span>{{ reservation.service.duration }} minutes</span>
                </div>
                <div class="detail-item">
                    <label>Service Provider:</label>
                    <span>{{ reservation.service.provider ? reservation.service.provider.email : 'N/A' }}</span>
                </div>
            {% else %}
                <div class="detail-item">
                    <span>No service information available</span>
                </div>
            {% endif %}
        </div>
    </div>

    <div class="detail-section">
        <h3>Client Information</h3>
        <div class="detail-grid">
            {% if reservation.client %}
                <div class="detail-item">
                    <label>Client:</label>
                    <span>{{ reservation.client.email }}</span>
                </div>
                <div class="detail-item">
                    <label>Client Phone:</label>
                    <span>{{ reservation.client.phone ?? 'N/A' }}</span>
                </div>
            {% else %}
                <div class="detail-item">
                    <span>No client information available</span>
                </div>
            {% endif %}
        </div>
    </div>

    <div class="detail-section">
        <h3>Date & Time</h3>
        <div class="detail-grid">
            <div class="detail-item">
                <label>Reservation Date:</label>
                <span>{{ reservation.reservationDate ? reservation.reservationDate|date('l, F j, Y') : 'N/A' }}</span>
            </div>
            <div class="detail-item">
                <label>Start Time:</label>
                <span>{{ reservation.startTime ? reservation.startTime|date('H:i') : 'N/A' }}</span>
            </div>
            <div class="detail-item">
                <label>End Time:</label>
                <span>{{ reservation.endTime ? reservation.endTime|date('H:i') : 'N/A' }}</span>
            </div>
            <div class="detail-item">
                <label>Duration:</label>
                <span>
                    {% if reservation.startTime and reservation.endTime %}
                        {{ ((reservation.endTime.getTimestamp - reservation.startTime.getTimestamp) / 60)|round }} minutes
                    {% else %}
                        N/A
                    {% endif %}
                </span>
            </div>
        </div>
    </div>

    <div class="detail-actions">
        <form method="post" action="{{ path('app_admin_reservation_delete', {'id': reservation.id}) }}" onsubmit="return confirm('Are you sure you want to delete this reservation?');">
            <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ reservation.id) }}">
            <button type="submit" class="btn btn-danger">Delete Reservation</button>
        </form>
    </div>
</div>
{% endblock %}
